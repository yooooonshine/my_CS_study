* ![[Pasted image 20231013112157.png]]
* 조건을 걸어서 pay, 즉 한달 뒤에 사용할 수 있도록 등
* 즉 그 기간동안 무슨 일이 있으면, 번복하고나 그런 것
* transaction이나 output에 lock을 걸어, 이후에만 spend할 수 있도록
* 두가지
	* transaction level timelocks
	* utxo level timelock: 각 개별 레벨에도 락을 걸 수 있도록
* transaction이란 input output을 연결 하는 것.
* 
* ![[Pasted image 20231013112056.png]]
* nlocktime이란 transaction의 필드이고 값을 지정함으로서 미래 시점을 지정할 수 있다.
* 즉 트랜스엑션이 유효하여 블록체인에 포함될 수 있는 가장 빠른 시점을 의미
* 대부분이 lock이 없다
* 만약 걸렸다면 0이 아닌값
	* 1. block height , 5억보다 작다고 설정하면( block height, 최초로 연결된 block이 genesis block, 이 후 height가 1씩증가, ) 5억이 될 때까지 락이 걸린다.
	* 2. >= 5억 이면, unic epoch timestamp로 이해해서, 시간으로 계산
* ![[Pasted image 20231013112935.png]]
* ![[Pasted image 20231013113033.png]]
* 이건 일종의 op코드
* output마다 설정될 수 있는 lock, (엘리스가 bob에게 돈보낼때, bob에거 설정하는 것)
* 특정 시간이 지났다면 그대로 진행
* 아니면 invalid
* cltv만족 확인
* cltv는 파라미터가 필요,  lock시킬 시간을 알려주는 것.
	* 다만 포맷이 nlocktime이랑 똑같아야함, nlocktime이 시간이면 이것도 시간
* ![[Pasted image 20231013113350.png]]
	* bob에게 지불할 때 조건을 걸고 싶을때,
	* <>는 value
	* 지금으로부터 3달 후를 표현? -> 지금의 unix 찾아서 3달 계산 후 추가
	* 혹은 block은 평균 10분마다이므로, 3달후를 계산해서 nlockblock
	* drop은 스택에 \<now 3month> 있으므로 지우기 위해서.
* ![[Pasted image 20231013113909.png]]
	* cltv는 결과에 lock, 전체에 lock하는 것이 더 엄격해야하므로 , 이게 기간이 더 길어야한다.
* ![[Pasted image 20231013114146.png]]
	* stack empty -> 검증할 시간이 없다.
	* 2. lock time은 미래여야하므로 음수 x
	* nSequnece라는 필드가 존재 -> 내 거래가 안될때, fee를 더 높이기 위해 사용하는 필드, 즉 nSequnece가 커지면 더 최신 것임을 의미
	* 
	* 