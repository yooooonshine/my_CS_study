## Anormaly (이상 현상)
데이터베이스 설계를 잘 못하여 삽입, 삭제, 수정을 하였을 때 논리적으로 생기는 오류
* 수정 이상
* 삭제 이상
* 삽입 이상

![[Pasted image 20231121192515.png]]
예를 들어 위 테이블에서 학번만  키로 갖는 이름을 테이블 속성에 넣었다. 
* 여기서 1번 튜플의 김사랑을 김지연으로 변경한다고 하면 3번 튜플도 반영되어야 하는 데 반영되지 않는다. 이것이 수정이상이다.
* 여기서 5번 튜플을 지우면 이 테이블에는 이선균이라는 사람 자체에 대한 정보가 사라진다. 이는 원치 않은 결과이므로 이것이 삭제 이상.
* 한예슬이라는 학생을 넣을려하는데, 아직 수강신청을 안한경우, 과목명도 키이므로 무조건 존재해야한다. 즉 원치 않는 값을 넣어야 하므로 이것이 삽입 이상이다.

\#  학번 ->  과목명 은 틀리다. 학번이 같아도 과목명이 다른 경우가 있기 문이다.
## 정규화(normalization)
데이터 중복(redundancy)을 제거하며 더 좋은 데이터 베이스를 설계하는 것.
즉 위와 같은 이상들이 생기지 않도록 하며, 중복을 제거하여 바람직한 릴레이션 스키마로 만들어 나가는 것.



## 함수 종속(Functional dependenciest, FDs)
* X-> Y(X,Y는 테이블의 attribute)
* X determines Y
* Y is functionaly dependent on X
즉 X라는 속성(1개 이상의 속성)으로 인해 Y속성이 결정되는 것.
예를 들어 학번이라는 속성이 주어지면 그에 따른 이름은 같은 학번이 주어지면 무조건 동일하다.
X는 여기서 결정자(determinant)라고 한다.

\# 키는 모든 속성을 결정한다.

X-> Y에서
![[Pasted image 20231122230330.png]]
t1이라는 튜플과 t2라는 튜플이 r이라는 릴레이션에 속할 때, t1과 t2를 x로 projection하였을 경우 같다는 의미는 결국 다른 속성도 같다는 것. 결정자가 같으면 다른 속성도 같으니.
### Closure of  F
F로부터 얻어낼 수 있는 모든 함수적 종속성 FD를 closure of F라고 부른다. 이는 F+ 와 같다.
예를 들어 a-> b, b->c를 통해 a->c를 구할 수 있다. 이 모든 함수적 종속성이 F+이다.
이렇게 나온 모든 결정자가 키가 아니면 보이스코드 정규형이 아니다.
### 암스트롱의 공리(Armstrong's Axioms)
어떤  테이블 X,Y,Z가 있을 떄 함수 종속은 다음을 만족한다는 것
* Reflexivity: Y가 X의 부분 집합이면 X-> Y이다.
* Augmentation: X->Y 이면 XZ -> YZ이다.
* Transitivity: X->Y이고 Y->Z이면 X->Z이다.
* self-determination: 자기 자신은 자신에 의해 함수 종속적이다. 즉 X->X이다.
* union: X->Y이고 X->Z 이면 X->YZ 이다.
* decomposition: X->YZ이면 X->Y, X->Z 이다.

## 함수 종속의 성질
* 완전 함수 종속(full functional dependency)
* 부분 함수 종속(partial functional dependency)
예를 들어 (학번, 과목명)이 슈퍼키라고 하자. 다른 속성으로는 이름, 성적이 존재하는데, 여기서 이름은 오직 학번만 필요로 하므로 부분 함수 종속(부분키만을 필요로 한다.)이고 성적은 학번과 과목명이 모두 주어져야 나오므로 완전 함수 종속이라고 한다.

## 정규형
테이블의 정규화된 정도
![[Pasted image 20231121193833.png]]
### 제 1 정규형(1nf, 1 normal form): 
릴레이션의 모든 속성(도메인)이 atomic value이다. 즉 한 속성의 값이 두개이상의 값을 갖지 않는다. 
![[Pasted image 20231121194031.png]]
예시로 위와 같은 경우는 한 속성안에 과목을 두개 두고 , 성적도 두 개를 두므로 제 1 정규형에 어긋난다.

### 제2 정규형
릴레이션이 제 1정규형이며, 키에 속하지 않는 속성 모두가 완전 함수 종속이어야 한다. 
![[Pasted image 20231121192515.png]]
즉 위와 같은 경우는 이름이 부분 함수 종속이므로 제 2 정규형이 되지 못한다.
\# 제 2 정규형이 되기 위하여 테이블을 분리하였을 경우 분리한 테이블을 join하면 이전의 테이블이 완전하게 나와야 한다. 이를 무손실 분해(nonless decomposition)이라고 한다.

### 제 3정규형
릴레이션이 제 2 정규형이면서, 모든 속성들이 기본키에 이행적 함수 종속(transitive FD, functional dependency))를 제외

이행적 함수 종속성이란: 3개의 속성에 존재하는 함수 종속성을 의미한다.
![[Pasted image 20231121194548.png]]
A->B이고 B->C인데, A->C이면 이행적 함수 종속성에 해당한다.
이렇게 되면 여러 anormaly 현상이 생긴다. B로 인해 C가 결정되므로 한 테이블에 c가 중복된다.
따라서 테이블을 AB, BC로 분리하면 해결된다.

### 보이스/코드 정규형
제 3 정규형을 만족하면서, 모든 결정자가 키이거나 후보키이다.(즉 유일성을 갖는다.)
\# 참고로 보이스코드 정규형으로 만드는 것은 매우 어려운 일이다. 제 3정규형까지는 만들 수 있으나, 보이스코드 정규형으로는 못 갈 수 있다.

예를 들어 학번 -> 교수명, 교수명-> 과목명 이라고 할떄,  학번, 과목명을 키로 두자. 그럼 교수명은 결정자이면서도 후보키가 아니므로 이는 보이스코드 정규형이 아니다. 이런 테이블은 이상 현상을 발생시킨다. 
![[Pasted image 20231122225807.png]]
이 그림을 보면 